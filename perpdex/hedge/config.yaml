# Delta Neutral Volume Farming Bot Configuration
# ================================================
# API 키는 .env에서 관리 (이 파일은 Git에 커밋 가능)
#
# 우선순위: CLI 인자 > config.yaml > 하드코딩 기본값
#
# 사용법:
#   python hedge_mode.py --exchange backpack --ticker ETH --size 0.05 --iter 20

trading:
  # 기본 주문 수량 (CLI --size 미지정 시 사용)
  # 테스트: 0.01 (약 $5), 예시: 0.05 (약 $100)
  default_size: 0.01

  # 기본 반복 횟수 (CLI --iter 미지정 시 사용)
  default_iterations: 10

  # 포지션 불균형 허용치
  # |Backpack_position + Lighter_position| 기준
  # 이 값 초과 시 경고 로그 출력
  position_diff_threshold: 0.2

  # 주문 취소 타임아웃 (초)
  # 미체결 주문이 이 시간 후 취소되고 재주문
  order_cancel_timeout: 10

  # 트레이딩 루프 타임아웃 (초)
  # 전체 루프가 이 시간 내 완료되어야 함
  trading_loop_timeout: 180

  # 최대 재시도 횟수
  # API 호출 실패 시 재시도 횟수
  max_retries: 15

  # 체결 확인 간격 (초)
  # 주문 체결 여부 확인 주기
  fill_check_interval: 10

monitoring:
  # 펀딩비 로깅 활성화
  funding_fee_logging: true

  # 펀딩비 로깅 주기 (iterations)
  # 예: 5 = 5회 반복마다 펀딩비 로그 출력
  funding_fee_log_interval: 5

  # 펀딩비 경고 임계값 (USD)
  # 누적 펀딩비가 이 값 초과 시 경고
  funding_fee_warning_threshold: -10.0

  # 잔고 로깅 활성화
  balance_logging: true

  # 잔고 로깅 주기 (iterations)
  # 예: 5 = 5회 반복마다 잔고 로그 출력
  balance_log_interval: 5

  # 잔고 불균형 경고 임계값 (비율)
  # 예: 0.3 = 한쪽 잔고가 30% 이상 줄어들면 경고
  balance_warning_threshold: 0.3

pricing:
  # 매수가 조정 (시장가 × 이 값)
  # 예: 0.998 = 시장가보다 0.2% 낮게 주문 (post-only maker)
  buy_price_multiplier: 0.998

  # 매도가 조정 (진입가 × 이 값)
  # 예: 1.002 = 진입가보다 0.2% 높게 청산 주문
  sell_price_multiplier: 1.002

progressive_sizing:
  # Progressive sizing 활성화 여부
  enabled: true  # ✅ Lighter 인증 수정 완료 후 활성화

  # 초기 사이즈 (SOL)
  initial_size: 0.1

  # 검증 메커니즘
  validation_count: 3        # 각 사이즈당 3회 연속 성공 필요
  size_multiplier: 2.0       # 검증 통과 시 2배 증가

  # 3단계 목표 설정 (USD)
  phase_targets:
    - max_position_value_usd: 1000.0   # Phase 1: $1K
    - max_position_value_usd: 5000.0   # Phase 2: $5K
    - max_position_value_usd: 25000.0  # Phase 3: $25K

  # 안전 장치
  downgrade_on_failure: true           # 실패 시 이전 사이즈로 복귀
  max_consecutive_failures: 2          # 연속 실패 2회까지 허용

  # Phase 전환 승인
  manual_phase_approval: true          # Phase 전환 시 사용자 승인 필요

hedge_verification:
  # REST API 포지션 검증 활성화 여부
  # 매 반복 시작 전 양쪽 거래소의 실제 포지션을 REST API로 조회하여 헷지 균형 확인
  enabled: true

  # 포지션 허용 오차 (ETH)
  # 실제 포지션과 추적된 포지션의 차이가 이 값 초과 시 추적 포지션 업데이트
  # 예: 0.001 = 0.001 ETH 이상 차이나면 조정
  position_tolerance: 0.001

  # REST API 포지션 조회 최대 재시도 횟수
  max_retries: 3

  # 재시도 간 대기 시간 (초)
  retry_delay: 2

  # 검증 실패 시 봇 중지 여부
  # true: 헷지 불균형 감지 시 즉시 봇 중지하고 텔레그램 알림
  # false: 경고만 로깅하고 계속 실행 (권장하지 않음)
  stop_on_failure: true

# 참고: 아래 값들은 CLI에서만 설정 가능
# --exchange: 거래소 (backpack, extended)
# --ticker: 거래 심볼 (BTC, ETH, SOL)
# --size: 주문 수량 (미지정 시 trading.default_size 사용)
# --iter: 반복 횟수 (미지정 시 trading.default_iterations 사용)
# --fill-timeout: 체결 대기 시간
# --env-file: .env 파일 경로
